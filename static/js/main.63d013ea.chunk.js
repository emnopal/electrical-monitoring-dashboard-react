(this["webpackJsonpelectrical-monitoring-dashboard-react"]=this["webpackJsonpelectrical-monitoring-dashboard-react"]||[]).push([[0],{17:function(t,e,a){},31:function(t,e,a){t.exports=a(43)},41:function(t,e,a){},42:function(t,e,a){},43:function(t,e,a){"use strict";a.r(e);var s=a(1),i=a.n(s),r=a(23),n=a.n(r),l=(a(17),a(18),a(19),a(15)),o=a(11),c=a(24);const h=Object(c.a)({apiKey:"AIzaSyA_EQE5bF9HJf_Pc_S_xCYdB-dn7ikjkHs",authDomain:"electrical-monitoring-3303b.firebaseapp.com",databaseURL:"https://electrical-monitoring-3303b-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"electrical-monitoring-3303b",storageBucket:"electrical-monitoring-3303b.appspot.com",messagingSenderId:"206511979734",appId:"1:206511979734:web:289e6e6fe3af55b8b4dd77",measurementId:"G-VW6VGF11K4"}),d=Object(o.c)(h);var m=Object(o.d)(d);var u=t=>new Intl.DateTimeFormat("id-ID",{dateStyle:"full",timeStyle:"long",timeZone:"UTC"}).format(new Date(t));var p=(t,e)=>{const a={};return Object.keys(t).forEach(e=>{Object.keys(t[e]).forEach(s=>{const i=t[e][s],r=i.timestamp;a[r]=t[e][s],a[r].Current=parseFloat(i.Current),a[r].Energy=parseFloat(i.Energy),a[r].Frequency=parseFloat(i.Frequency),a[r].Power=parseFloat(i.Power),a[r]["Power Factor"]=parseFloat(i["Power Factor"]),a[r]["Total Price"]=parseFloat(i["Total Price"]),a[r].Voltage=parseFloat(i.Voltage),a[r].readable_timestamp=u(1e3*i.timestamp)})}),e?"json"===e.toLowerCase()?JSON.stringify(a,null,4):"array"===e.toLowerCase()?Object.values(a):JSON.stringify(a,null,4):a};var b=class{constructor(t){this.obj=t}getKeys(){if(Array.isArray(this.obj))throw"Must be Object";return Object.keys(this.obj)}getValue(t,e){let a=this.obj;return Array.isArray(a)?(a=this.sortObj(t,e),a.map(e=>e[t])):Object.values(a).map(e=>e[t])}getValueObj(t,e,a){return this.getValueAll(t,e,a)}getValueArr(t,e,a){return this.getValueAll(t,e,a,"array")}getValueAll(t,e,a,s){let i=0;("string"===typeof t||t instanceof String)&&(t=[t],i=1);const r=this.sortObj(null!==e&&void 0!==e?e:"timestamp",a);if("array"===s){const e=r.map(e=>t.map(t=>e[t]));return 1===i?e.flat(1):e}return r.map(e=>{const a={};return t.map(t=>{a[t]=e[t]}),a})}sortObj(t,e){const a=this.obj;let s=1,i=-1;if(!Array.isArray(a))throw"Must be Array";return"desc"===e&&(s=-1,i=1),a.sort((e,a)=>e[t]<a[t]?s:i)}getHighestObjByKey(t){return this.sortObj(t)[0]}getLowestObjByKey(t){return this.sortObj(t,"desc")[0]}getHighestValueByKey(t){return this.getHighestObjByKey(t)[t]}getLowestValueByKey(t){return this.getLowestObjByKey(t)[t]}},g=a(12),E=a(29),f=a(6),y=a(25);class v extends s.Component{componentDidMount(){this.createStockChart()}componentDidUpdate(){this.createStockChart()}createStockChart(){let t,e;"dark"===this.props.theme?(t="#121212FF",e="#FFFFFFFF"):(t="#FFFDFDFF",e="#000000FF");let a=[];a=this.props.data.map(t=>[new Date(1e3*(parseInt(t.timestamp)+25200)).getTime(),t[this.props.title]]).reverse(),y.stockChart("chart",{chart:{backgroundColor:t},rangeSelector:{selected:1},title:{text:this.props.title,style:{color:e}},series:[{name:this.props.title,data:a,marker:{enabled:!0,radius:3},tooltip:{valueDecimals:2}}]})}render(){return i.a.createElement("div",{id:"chart"},"Highstock")}}var k=v;class S{static sortObj(t,e,a){const s=[...t];let i=1,r=-1;return"desc"===a&&(i=-1,r=1),s.sort((t,a)=>t[e]<a[e]?i:r)}static convertLocale(t){return new Date(1e3*t).toLocaleString("id-ID")}static findMean(t,e){const a=[...t],{length:s}=a;return a.reduce((t,a)=>t+a[e]/s,0)}static getArrFromObj(t,e){return S.sortObj(t,e).map(t=>t[e])}static findQuantile(t,e,a){const s=S.getArrFromObj(t,e),i=(s.length-1)*a,r=Math.floor(i),n=i-r;return void 0!==s[r+1]?s[r]+n*(s[r+1]-s[r]):s[r]}static findMedian(t,e){return S.findQuantile(t,e,.5)}static findStd(t,e){const a=S.findMean(t,e),s=S.getArrFromObj(t,e),i=s.map(t=>(t-a)**2);return Math.sqrt(i.reduce((t,e)=>t+e,0)/(s.length-1))}}var F=S;class j extends s.Component{constructor(t){super(t),this.state={title:t.title,data:t.data,units:t.units,highest:F.sortObj(t.data,t.title)[0][t.title],lowest:F.sortObj(t.data,t.title,"desc")[0][t.title],timeHighest:F.convertLocale(F.sortObj(t.data,t.title)[0].timestamp),timeLowest:F.convertLocale(F.sortObj(t.data,t.title,"desc")[0].timestamp),mean:F.findMean(t.data,t.title),median:F.findMedian(t.data,t.title),std:F.findStd(t.data,t.title),latestData:F.sortObj(t.data,"timestamp")[0][t.title],latestTime:F.convertLocale(F.sortObj(t.data,"timestamp")[0].timestamp),firstData:F.sortObj(t.data,"timestamp","desc")[0][t.title],firstTime:F.convertLocale(F.sortObj(t.data,"timestamp","desc")[0].timestamp)}}componentDidUpdate(t,e,a){t.title!==this.props.title&&t.data!==this.props.data&&this.setState({title:this.props.title,data:this.props.data,units:this.props.units,highest:F.sortObj(this.props.data,this.props.title)[0][this.props.title],lowest:F.sortObj(this.props.data,this.props.title,"desc")[0][this.props.title],timeHighest:F.convertLocale(F.sortObj(this.props.data,this.props.title)[0].timestamp),timeLowest:F.convertLocale(F.sortObj(this.props.data,this.props.title,"desc")[0].timestamp),mean:F.findMean(this.props.data,this.props.title),median:F.findMedian(this.props.data,this.props.title),std:F.findStd(this.props.data,this.props.title),latestData:F.sortObj(this.props.data,"timestamp")[0][this.props.title],latestTime:F.convertLocale(F.sortObj(this.props.data,"timestamp")[0].timestamp),firstData:F.sortObj(this.props.data,"timestamp","desc")[0][this.props.title],firstTime:F.convertLocale(F.sortObj(this.props.data,"timestamp","desc")[0].timestamp)})}renderOther(){return i.a.createElement("div",null,i.a.createElement("h6",null,"Mean ",this.state.title,": ",this.state.mean," ",this.state.units),i.a.createElement("h6",null,"Median ",this.state.title,": ",this.state.median," ",this.state.units),i.a.createElement("h6",null,"Standard Deviation ",this.state.title,": ",this.state.std," ",this.state.units),i.a.createElement("br",null),i.a.createElement("h6",null,"Highest ",this.state.title,": ",this.state.highest," ",this.state.units," (",this.state.timeHighest,")"),i.a.createElement("h6",null,"Lowest ",this.state.title,": ",this.state.lowest," ",this.state.units," (",this.state.timeLowest,")"),i.a.createElement("br",null),i.a.createElement("h6",null,"Latest Data of ",this.state.title,": ",this.state.latestData," ",this.state.units," (",this.state.latestTime,")"),i.a.createElement("h6",null,"First Data of ",this.state.title,": ",this.state.firstData," ",this.state.units," (",this.state.firstTime,")"))}renderCurrency(){return i.a.createElement("div",null,i.a.createElement("h6",null,"Mean ",this.state.title,": ",this.state.units,this.state.mean),i.a.createElement("h6",null,"Median ",this.state.title,": ",this.state.units,this.state.median),i.a.createElement("h6",null,"Standard Deviation ",this.state.title,": ",this.state.units,this.state.std),i.a.createElement("br",null),i.a.createElement("h6",null,"Highest ",this.state.title,": ",this.state.units,this.state.highest," (",this.state.timeHighest,")"),i.a.createElement("h6",null,"Lowest ",this.state.title,": ",this.state.units,this.state.lowest," (",this.state.timeLowest,")"),i.a.createElement("br",null),i.a.createElement("h6",null,"Latest Data of ",this.state.title,": ",this.state.units,this.state.latestData," (",this.state.latestTime,")"),i.a.createElement("h6",null,"First Data of ",this.state.title,": ",this.state.units,this.state.firstData," (",this.state.firstTime,")"))}render(){let t;return t="Total Price"===this.state.title?this.renderCurrency():this.renderOther(),i.a.createElement("div",null,t)}}var w=j,D=a(44);class O extends s.Component{constructor(t){super(t),this.state={title:t.title,data:t.data,units:t.units}}componentDidUpdate(t,e,a){t.title!==this.props.title&&t.data!==this.props.data&&this.setState({title:this.props.title,data:this.props.data,units:this.props.units})}convertLocale(t){return new Date(1e3*t).toLocaleString("id-ID")}render(){let t;return t="dark"===this.props.theme?"text-light bg-dark":"text-dark bg-light",i.a.createElement(D.a,{className:"table-light"},i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",{className:t},this.state.title," (in ",this.state.units,")"),i.a.createElement("th",{className:t},"Timestamp (s)"),i.a.createElement("th",{className:t},"Readable Timestamp (GMT+7)"))),i.a.createElement("tbody",null,this.state.data.map((e,a)=>i.a.createElement("tr",{key:a},i.a.createElement("td",{className:t},"Total Price"===this.state.title?this.state.units+" ":"",e[this.state.title],"Total Price"!==this.state.title?" "+this.state.units:""),i.a.createElement("td",{className:t},e.timestamp),i.a.createElement("td",{className:t},this.convertLocale(e.timestamp))))))}}var C=O,M=a(8),L=a.n(M),N=a(26),A=a.n(N),x=a(27),T=a.n(x);class H{static sortObj(t,e){const a=[...t];let s=1,i=-1;return"desc"===e&&(s=-1,i=1),a.sort((t,e)=>t<e?s:i)}static findMean(t){const e=[...t],{length:a}=e;return e.reduce((t,e)=>t+e/a,0)}static findSum(t){return[...t].reduce((t,e)=>t+e,0)}static findQuantile(t,e){const a=(t.length-1)*e,s=Math.floor(a),i=a-s;return void 0!==t[s+1]?t[s]+i*(t[s+1]-t[s]):t[s]}static findMedian(t){return H.findQuantile(t,.5)}static findStd(t){const e=H.findMean(t),a=t.map(t=>(t-e)**2);return Math.sqrt(H.findSum(a)/(t.length-1))}}var I=H;A()(L.a),T()(L.a);class P extends s.Component{componentDidUpdate(){this.createGaugeChart()}componentDidMount(){this.createGaugeChart()}createGaugeChart(){const t=this.props.data.map(t=>t[this.props.title]);let e,a;"dark"===this.props.theme?(e="#121212FF",a="#FFFFFFFF"):(e="#FFFDFDFF",a="#000000FF"),L.a.chart("gaugeChart",{rangeSelector:{selected:1},chart:{type:"gauge",backgroundColor:e},title:{text:this.props.title,style:{color:a}},pane:{startAngle:-90,endAngle:90,background:null,center:["50%","75%"],size:"100%"},yAxis:{min:Math.min(...t),max:Math.max(...t),tickPixelInterval:72,tickPosition:"inside",tickColor:e,tickLength:20,tickWidth:2,minorTickInterval:null,labels:{distance:20,style:{fontSize:"14px",color:a}},plotBands:[{from:Math.min(...t),to:I.findQuantile(t,.25),color:"#55BF3B",thickness:20},{from:I.findQuantile(t,.25),to:I.findQuantile(t,.75),color:"#DDDF0D",thickness:20},{from:I.findQuantile(t,.75),to:Math.max(...t),color:"#DF5353",thickness:20}]},series:[{name:this.props.title,data:[I.findMean(t)],tooltip:{valueSuffix:" "+this.props.units},dataLabels:{format:"Total Price"===this.props.title?this.props.units+"{y} ":"{y} "+this.props.units,borderWidth:0,color:a,style:{fontSize:"16px"}},dial:{radius:"80%",backgroundColor:"gray",baseWidth:12,baseLength:"0%",rearLength:"0%"},pivot:{backgroundColor:"gray",radius:6}}]})}render(){return i.a.createElement("div",null,i.a.createElement("div",{id:"gaugeChart"}))}}var V=P;class B extends s.Component{constructor(t){super(t),this.state={title:t.title}}componentDidUpdate(t,e,a){t.title!==this.props.title&&this.setState({title:this.props.title})}render(){return i.a.createElement(g.a,null,i.a.createElement("h1",null,"Welcome!"))}}var W=B;class z extends s.Component{constructor(t){super(t),this.state={time:(new Date).toLocaleString()}}componentDidMount(){this.intervalID=setInterval(()=>this.tick(),1e3)}componentWillUnmount(){clearInterval(this.intervalID)}tick(){this.setState({time:(new Date).toLocaleString()})}render(){return i.a.createElement("span",{className:"App-clock"},"Current datetime: ",this.state.time)}}var U=z;class K extends s.Component{constructor(t){super(t),this.state={selected:0,data:l.cloneDeep([]),title:"init",theme:localStorage.getItem("theme")},this.zeroSelected=this.zeroSelected.bind(this),this.currentSelected=this.keySelected.bind(this,1,"Current","A"),this.energySelected=this.keySelected.bind(this,2,"Energy","J"),this.frequencySelected=this.keySelected.bind(this,3,"Frequency","Hz"),this.powerFactorSelected=this.keySelected.bind(this,4,"Power Factor","W"),this.powerSelected=this.keySelected.bind(this,5,"Power","W"),this.priceSelected=this.keySelected.bind(this,6,"Total Price","Rp. "),this.voltageSelected=this.keySelected.bind(this,7,"Voltage","V")}async keySelected(t,e,a){const s=await Object(o.b)(Object(o.a)(m,"UsersData/lj5wFISAS5UhwklM3NVWReXmbpm2"));if(s.exists()){const i=p(s.val(),"array"),r=new b(i).getValueAll([e,"timestamp"],null,null,"object");this.setState({selected:t,data:l.cloneDeep(r),title:e,units:a})}}zeroSelected(){this.setState({selected:0,data:null,title:null})}DarkMode(){const t=()=>{localStorage.setItem("theme","dark"),document.documentElement.setAttribute("data-theme","dark")},e=localStorage.getItem("theme"),a=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches,s="dark"===e||null===e&&a;s&&t();return i.a.createElement("div",{className:"toggle-theme-wrapper"},i.a.createElement("span",{role:"img","aria-label":"light"},"\u2600\ufe0f"),i.a.createElement("label",{className:"toggle-theme",htmlFor:"checkbox"},i.a.createElement("input",{type:"checkbox",id:"checkbox",onChange:e=>{e.target.checked?(t(),this.setState({theme:"dark"})):(localStorage.setItem("theme","light"),document.documentElement.setAttribute("data-theme","light"),this.setState({theme:"light"}))},defaultChecked:s}),i.a.createElement("div",{className:"slider round"})),i.a.createElement("span",{role:"img","aria-label":"dark"},"\ud83c\udf12"))}Header(t){return i.a.createElement(g.a,null,i.a.createElement("div",{className:"col-lg-6"},i.a.createElement("div",{className:"input-group"},i.a.createElement("span",{className:"input-group-btn"},this.DarkMode()),i.a.createElement("span",{className:"input-group-btn",style:{position:"relative",top:"2.5px",left:"120%"}},i.a.createElement("a",{href:"https://github.com/emnopal/electrical-monitoring-dashboard-react",target:"_blank",rel:"noopener noreferrer"},i.a.createElement("button",{className:"btn btn-default",type:"button",style:{color:t}},"Repository")),i.a.createElement("a",{href:"https://github.com/emnopal",target:"_blank",rel:"noopener noreferrer"},i.a.createElement("button",{className:"btn btn-default",type:"button",style:{color:t}},"Follow my Github"))))),i.a.createElement("br",null),i.a.createElement("br",null),i.a.createElement("h1",null,"Electrical Monitoring Dashboard"),"Note: Time in UTC+7 (Asia/Jakarta) (",i.a.createElement(U,null),")")}zeroHandlerSelected(){return i.a.createElement(g.a,null,i.a.createElement(W,{title:this.state.title}))}otherHandlerSelected(){return i.a.createElement(g.a,null,i.a.createElement("div",{className:"statHeaders"},i.a.createElement(w,{data:this.state.data,title:this.state.title,units:this.state.units,theme:this.state.theme}),i.a.createElement(V,{data:this.state.data,title:this.state.title,units:this.state.units,theme:this.state.theme})),i.a.createElement("div",null,i.a.createElement("br",null),i.a.createElement(k,{data:this.state.data,title:this.state.title,theme:this.state.theme}),i.a.createElement("br",null),i.a.createElement(C,{data:this.state.data,title:this.state.title,units:this.state.units,theme:this.state.theme})))}buttonHandler(){return i.a.createElement(E.a,{className:"justify-content-center"},i.a.createElement(f.a,{type:"button",className:"btn btn-highchart "+(0===this.state.selected?"active":""),onClick:this.zeroSelected},"Home"),i.a.createElement(f.a,{type:"button",className:"btn btn-highchart "+(1===this.state.selected?"active":""),onClick:this.currentSelected},"Current"),i.a.createElement(f.a,{type:"button",className:"btn btn-highchart "+(2===this.state.selected?"active":""),onClick:this.energySelected},"Energy"),i.a.createElement(f.a,{type:"button",className:"btn btn-highchart "+(3===this.state.selected?"active":""),onClick:this.frequencySelected},"Frequency"),i.a.createElement(f.a,{type:"button",className:"btn btn-highchart "+(4===this.state.selected?"active":""),onClick:this.powerFactorSelected},"Power Factor"),i.a.createElement(f.a,{type:"button",className:"btn btn-highchart "+(5===this.state.selected?"active":""),onClick:this.powerSelected},"Power"),i.a.createElement(f.a,{type:"button",className:"btn btn-highchart "+(6===this.state.selected?"active":""),onClick:this.priceSelected},"Total Price"),i.a.createElement(f.a,{type:"button",className:"btn btn-highchart "+(7===this.state.selected?"active":""),onClick:this.voltageSelected},"Voltage"))}render(){let t,e;t=0===this.state.selected?this.zeroHandlerSelected():this.otherHandlerSelected(),e="light"===this.state.theme?"black":"white";const a=this.buttonHandler();return i.a.createElement("div",{className:"App"},i.a.createElement(g.a,null,i.a.createElement("br",null),this.Header(e),a,i.a.createElement("br",null),t))}}var Q=K;a(41),a(42);n.a.render(i.a.createElement(Q,null),document.getElementById("root")),"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/electrical-monitoring-dashboard-react/service-worker.js").then(t=>{t.onupdatefound=()=>{const e=t.installing;e.onstatechange=()=>{"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(t=>{console.error("Error during service worker registration:",t)})})}},[[31,1,2]]]);
//# sourceMappingURL=main.63d013ea.chunk.js.map